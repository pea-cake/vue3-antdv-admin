import{ds as Ee,dt as We,du as Ke,aQ as _e,c as b,H as s,ad as Ae,dv as Ne,dw as qe,cK as R,d as ce,a5 as Fe,e as j,cH as Ue,dx as _,cb as te,N as ae,r as ve,aY as ye,K as ue,$ as q,w as de,y as ze,J as U,z as Ge,C as $,v as I,dd as Q,F as z,X as se,q as be,a6 as Y,x as Se,L as re,dy as He,am as $e,T as we,a_ as Ye,cu as Je,ac as Xe,n as je,dz as Ze,B as Qe,Y as et,cZ as tt,aC as ge,dA as X,bi as nt,de as ke,dB as st,dC as ot,cO as at}from"./index-CLE865zi.js";import{i as Pe}from"./isNumber-DuiY7kzJ.js";import{c as rt,s as ct,d as lt,e as it,f as ut}from"./ApiSelect.vue_vue_type_script_setup_true_lang-DjZv7itZ.js";import{d as Ce}from"./dayjs.min-oWglilSk.js";import{i as Z}from"./is-CRxDFdx9.js";import{c as dt}from"./cloneDeep-BKIs_T9V.js";import{b as ft,C as mt,A as pt,F as Re}from"./index-DLjJ34Ye.js";import{d as ht}from"./debounce-DRRJQWG2.js";import{D as yt}from"./index-DRjcgh4c.js";import{D as gt}from"./DownOutlined-cuySjEGe.js";import{d as Ie}from"./index-DRPd0vz7.js";import{d as Te}from"./dateUtil-6XP-vD3c.js";import{b as vt}from"./_baseUniq-C2y4DHHK.js";import{p as bt}from"./pick-Dd397G7n.js";var St="[object Boolean]";function oe(a){return a===!0||a===!1||Ee(a)&&We(a)==St}function Me(a){return a==null}function wt(a){return a===null}function At(a){return a===void 0}function Pt(a,h){return a&&a.length?vt(a,ft(h)):[]}function Oe(a,h){return a==null?!0:Ke(a,h)}const Ve=_e(mt),Rt=_e(pt);function xt(a,h){return b(()=>{const f=s(a),{labelCol:v={},wrapperCol:y={}}=f.formItemProps||{},{labelWidth:d,disabledLabelWidth:B}=f,{labelWidth:p,labelCol:S,wrapperCol:M,layout:T}=s(h);if(!p&&!d&&!S||B)return v.style={textAlign:"left"},{labelCol:v,wrapperCol:y};let x=d||p;const l={...S,...v},F={...M,...y};return x&&(x=Pe(x)?`${x}px`:x),{labelCol:{style:{width:x},...l},wrapperCol:{style:{width:T==="vertical"?"100%":`calc(100% - ${x})`},...F}}})}function Le(a,h=""){const{t:f}=Ae();if(a.includes("Input")||a.includes("Complete"))return`${f("common.inputText")}${h}`;const v=["Select","Cascader","Checkbox","CheckboxGroup","Switch","TreeSelect"];return a.includes("Picker")||v.includes(a)?`${f("common.chooseText")}${h}`:""}const Bt=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function Ft(){return[...Bt,"RangePicker"]}function kt(a,h){return a&&["Input","InputPassword","InputSearch","InputTextArea"].includes(a)&&h&&Pe(h)?`${h}`:h}const Ct=Ft(),De=Symbol("schema-form");async function It(a){Ne(De,a)}function xe(a={}){return qe(De,a)}const Tt={formModel:{type:Object,default:()=>({})},schema:{type:Object,default:()=>({})},tableInstance:{type:Object},tableRowKey:{type:[String,Number]}};function Mt(a,h="default",f){if(!a||!Reflect.has(a,h))return null;if(!R(a[h]))return console.error(`${h} is not a function!`),null;const v=a[h];return v?v(f):null}const Ot={maxWidth:{type:String,default:"600px"},showIndex:{type:Boolean},color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},placement:{type:String,default:"right"},text:{type:[Array,String]}},Lt=ce({name:"BasicHelp",components:{Tooltip:Fe},props:Ot,setup(a,{slots:h}){const f=b(()=>({color:a.color,fontSize:a.fontSize})),v=b(()=>({maxWidth:a.maxWidth}));function y(){const d=a.text;return _(d)?j("p",null,[d]):te(d)?d.map((B,p)=>j("p",{key:B},[j(ae,null,[a.showIndex?`${p+1}. `:"",B])])):null}return()=>j(Fe,{overlayClassName:"basic-help__wrap",title:j("div",{style:s(f)},[y()]),autoAdjustOverflow:!0,overlayStyle:s(v),placement:a.placement},{default:()=>[j("span",{class:"basic-help"},[Mt(h)||j(Ue,null,null)])]})}}),_t={class:"mr-[6px]"},$t={class:"ml-[6px]"},jt=ce({name:"SchemaFormItem",__name:"schema-form-item",props:Tt,emits:["update:formModel"],setup(a,{emit:h}){const f=a,v=h,y=xe(),{formPropsRef:d,setItemRef:B,updateSchema:p,getSchemaByField:S,appendSchemaByField:M}=y,{t:T}=Ae();function x(n){if(typeof n!="object"||n===null)return n;let o={};for(let e in n)n.hasOwnProperty(e)&&(o[e]=x(n[e]));return o}const l=ve(x(f.schema)),F=xt(l,d),w=b(()=>te(l.value.field)?l.value.field:l.value.field.split(".")),V=b({get(){return w.value.reduce((n,o)=>n==null?void 0:n[o],f.formModel)},set(n){const o=l.value.field.split("."),e=o.pop(),t=o.reduce((r,c)=>r[c]??(r[c]={}),f.formModel);t[e]=n,v("update:formModel",f.formModel)}}),g=b(()=>{const{component:n,componentProps:o}=l.value;if(!R(o)&&(o!=null&&o.vModelKey))return o.vModelKey;const e=_(n)&&["Switch","Checkbox"].includes(n),t=n==="Upload";return{true:"value",[`${e}`]:"checked",[`${t}`]:"file-list"}.true}),m=b(()=>{const{formModel:n,schema:o,tableInstance:e}=f,{mergeDynamicData:t}=s(d);return{field:o.field,formInstance:y,tableInstance:e,tableRowKey:f.tableRowKey,formModel:f.tableRowKey?n[f.tableRowKey]:n,values:{...t,...n},schema:b(()=>f.schema)}}),O=b(()=>{const{vShow:n,vIf:o,isAdvanced:e=!1}=s(l),{showAdvancedButton:t}=s(d),r=t&&oe(e)?e:!0;let c=!0,i=!0;return oe(n)&&(c=n),oe(o)&&(i=o),R(n)&&(c=n(s(m))),R(o)&&(i=o(s(m))),c=c&&r,{isShow:c,isIfShow:i}}),k=b(()=>{const{disabled:n}=s(d),{dynamicDisabled:o}=f.schema,{disabled:e=!1}=s(W);let t=!!n||e;return oe(o)&&(t=o),R(o)&&(t=o(s(m))),t}),P=(n,o=s(m))=>{if(_(n))return j(ae,null,[n]);if(ye(n))return n;if(R(n))return P(n(o));if(n&&Z(n)){const e=Object.keys(n);return e.some(t=>t.startsWith("_")||["setup","render"].includes(t))?n:e.reduce((t,r)=>(t[r]=(...c)=>P(n[r],...c),t),{})}return n},G=b(()=>{const n=f.schema.component;return _(n)?rt[n]??P(n):P(n)}),H=b(()=>{const n=f.schema.componentSlots??{};return _(n)||ye(n)?{default:(...o)=>P(n,o)}:P(n)}),E=b(()=>{const n=f.schema.label;return R(n)?n(s(m)):n}),W=b(()=>{const{schema:n}=f;let{componentProps:o={},component:e}=n;return R(o)&&(o=o(s(m))??{}),e!=="RangePicker"&&_(e)&&(o.placeholder??(o.placeholder=Le(e,E.value))),n.component==="Divider"&&(o=Object.assign({type:"horizontal"},o,{orientation:"left",plain:!0})),ye(G.value)&&Object.assign(o,G.value.props),o}),fe=b(()=>{const n=W.value;return Object.keys(n).reduce((o,e)=>{if(/^on([A-Z])/.test(e)){const t=e.replace(/^on([A-Z])/,"$1").toLocaleLowerCase();o[t]=n[e]}return o},{})}),le=b(()=>{const{helpMessage:n,helpComponentProps:o,subLabel:e}=f.schema,t=e?j("span",null,[E.value,ue(" "),j("span",{class:"text-secondary"},[e])]):P(E.value),r=R(n)?n(s(m)):n;return!r||Array.isArray(r)&&r.length===0?t:j("span",null,[t,j(Lt,q({placement:"top",class:"mx-1",text:r},o),null)])});function me(n,o,e){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?n.type=e?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?n.type="array":["InputNumber"].includes(o)&&(n.type="number")}const pe=b(()=>{var Be;const{rules:n=[],component:o,rulesMessageJoinLabel:e,dynamicRules:t,required:r}=f.schema;if(R(t))return t(s(m));let c=dt(n);const{rulesMessageJoinLabel:i}=s(d),u=Reflect.has(s(d),"rulesMessageJoinLabel")?e:i,A=_(o)?`${Le(o,E.value)}${u?E.value:""}`:void 0;function C(N,D){const ie=N.message||A;return D===void 0||wt(D)||Array.isArray(D)&&D.length===0||typeof D=="string"&&D.trim()===""||typeof D=="object"&&Reflect.has(D,"checked")&&Reflect.has(D,"halfChecked")&&Array.isArray(D.checked)&&Array.isArray(D.halfChecked)&&D.checked.length===0&&D.halfChecked.length===0?Promise.reject(ie):Promise.resolve()}const L=R(r)?r(s(m)):r;(!c||c.length===0)&&L&&(c=[{required:L,validator:C}]);const K=c.findIndex(N=>Reflect.has(N,"required")&&!Reflect.has(N,"validator"));if(K!==-1){const N=c[K];if(o&&_(o)){Reflect.has(N,"type")||(N.type=o==="InputNumber"?"number":"string"),N.message=N.message||A,(o.includes("Input")||o.includes("Textarea"))&&(N.whitespace=!0);const D=(Be=s(W))==null?void 0:Be.valueFormat;me(N,o,D)}}const J=c.findIndex(N=>N.max);return J!==-1&&!c[J].validator&&(c[J].message=c[J].message||T("component.form.maxTip",[c[J].max])),c}),ne=async n=>{try{const o=Object.assign(l.value,{loading:!0,componentProps:{...s(W),options:[]}});p(o);const e=await n(s(m)),{component:t}=s(l),r=o.componentProps;["Select","RadioGroup","CheckboxGroup"].some(c=>c===t)?r.options=e:["TreeSelect","Tree"].some(c=>c===t)&&(r.treeData=e),o.componentProps&&(o.componentProps.requestResult=e),o.loading=!1,p(o)}finally{await Xe(),l.value.loading=!1}},he=()=>{const n=W.value.request;if(n)if(R(n))ne(n);else{const{watchFields:o=[],options:e={},wait:t=0,callback:r}=n,c=o.map(i=>()=>f.formModel[i]);de(c,ht(()=>{ne(r)},t),{...e})}};return de(O,(n,o)=>{!Je(n,o)&&n.isIfShow&&n.isShow&&(S(f.schema.field)||M(f.schema),he())},{immediate:!0}),(n,o)=>O.value.isIfShow?ze((I(),$(s(Ve),Q(q({key:0},l.value.colProps)),{default:z(()=>[l.value.component==="Divider"?(I(),$(s(yt),Q(q({key:0},Object.assign(W.value))),{default:z(()=>[(I(),$(se(le.value)))]),_:1},16)):(I(),$(s(Re).Item,q({key:1},{...l.value.formItemProps,...s(F)},{label:le.value,name:w.value,rules:pe.value}),{default:z(()=>[l.value.beforeSlot?(I(),be(ae,{key:0},[s(_)(l.value.beforeSlot)?Y(n.$slots,l.value.beforeSlot,Q(q({key:0},m.value)),()=>[Se("span",_t,re(l.value.beforeSlot),1)],!0):U("",!0),s(R)(l.value.beforeSlot)?(I(),$(se(l.value.beforeSlot(m.value)),{key:1})):U("",!0)],64)):U("",!0),l.value.slot?Y(n.$slots,l.value.slot,Q(q({key:1},m.value)),void 0,!0):G.value?(I(),$(se(G.value),q({key:2,ref:s(B)(l.value.field)},W.value,{[g.value]:V.value,["onUpdate:"+g.value]:o[0]||(o[0]=e=>V.value=e),"allow-clear":!0,disabled:k.value,loading:l.value.loading},He(fe.value)),$e({_:2},[Object.is(l.value.loading,!0)?{name:"notFoundContent",fn:z(()=>[j(s(Ye),{size:"small"})]),key:"0"}:void 0,we(H.value,(e,t)=>({name:t,fn:z(r=>[(I(),$(se((e==null?void 0:e({...m.value,slotData:r}))??e),{key:t}))])}))]),1040,["disabled","loading"])):U("",!0),l.value.afterSlot?(I(),be(ae,{key:3},[s(_)(l.value.afterSlot)?Y(n.$slots,l.value.afterSlot,Q(q({key:0},m.value)),()=>[Se("span",$t,re(l.value.afterSlot),1)],!0):U("",!0),s(R)(l.value.afterSlot)?(I(),$(se(l.value.afterSlot(m.value)),{key:1})):U("",!0)],64)):U("",!0)]),_:3},16,["label","name","rules"]))]),_:3},16)),[[Ge,O.value.isShow]]):U("",!0)}}),Vt=je(jt,[["__scopeId","data-v-b223caaa"]]),Dt=ce({__name:"index",props:{expand:{type:Boolean}},setup(a){Ze(v=>({"4cf09dcc":f.value}));const h=a,f=b(()=>`${h.expand?0:.5}turn`);return(v,y)=>(I(),$(s(gt),{class:"collapse-icon"}))}}),Et=je(Dt,[["__scopeId","data-v-af0a3cde"]]),Wt=ce({name:"FormAction",inheritAttrs:!1,__name:"form-action",props:{showActionButtonGroup:{type:Boolean,default:!0},showResetButton:{type:Boolean,default:!0},showSubmitButton:{type:Boolean,default:!0},showAdvancedButton:{type:Boolean,default:!0},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:{type:Number,default:6},isAdvanced:Boolean,hideAdvanceBtn:Boolean},emits:["toggle-advanced"],setup(a,{emit:h}){const f=h,v=a,{t:y}=Ae(),{resetFields:d,submit:B}=xe(),p=b(()=>{const{showAdvancedButton:l,actionSpan:F,actionColOptions:w}=v,V=24-F,g=l?{span:V<6?24:V}:{};return{style:{textAlign:"right"},span:l?6:4,...g,...w}}),S=b(()=>Object.assign({text:y("common.resetText")},v.resetButtonOptions)),M=b(()=>Object.assign({text:y("common.queryText")},v.submitButtonOptions));function T(){f("toggle-advanced",v.isAdvanced)}const x=async l=>{await B(l).catch(()=>{})};return(l,F)=>{const w=Qe("a-button");return a.showActionButtonGroup?(I(),$(s(Ve),Q(q({key:0},p.value)),{default:z(()=>[Se("div",{style:et([{width:"100%"},{textAlign:p.value.style.textAlign}])},[j(s(Re).Item,null,{default:z(()=>[Y(l.$slots,"resetBefore"),a.showResetButton?(I(),$(w,q({key:0,type:"default",class:"mr-2"},S.value,{onClick:s(d)}),{default:z(()=>[ue(re(S.value.text),1)]),_:1},16,["onClick"])):U("",!0),Y(l.$slots,"submitBefore"),a.showSubmitButton?(I(),$(w,q({key:1,type:"primary",class:"mr-2"},M.value,{onClick:F[0]||(F[0]=V=>x(V))}),{default:z(()=>[ue(re(M.value.text),1)]),_:1},16)):U("",!0),Y(l.$slots,"advanceBefore"),a.showAdvancedButton&&!a.hideAdvanceBtn?(I(),$(w,{key:2,type:"link",size:"small",onClick:T},{default:z(()=>[ue(re(a.isAdvanced?s(y)("component.form.putAway"):s(y)("component.form.unfold"))+" ",1),j(s(Et),{class:"ml-1",expand:!a.isAdvanced},null,8,["expand"])]),_:1})):U("",!0),Y(l.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):U("",!0)}}}),Kt=a=>{const h=tt(),f=ve({...a}),v=ge({...a.initialValues}),y=ge({...a.initialValues}),d=ve(),B={...a.initialValues},p=new Map,S=new Map,M=ge({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),T=b(()=>({...h,...f.value})),x=b(()=>{const{baseRowStyle:F={},rowProps:w}=s(T);return{style:F,...w}}),l=b(()=>({...T.value,...M}));return de(()=>f.value.schemas,()=>{var F;(F=f.value.schemas)==null||F.forEach(w=>{!S.has(w.field)&&R(w.componentProps)&&S.set(w.field,w.componentProps),At(w.defaultValue)||X(y,w.field,w.defaultValue)})}),{formModel:v,defaultFormValues:y,schemaFormRef:d,formPropsRef:f,cacheFormModel:B,compRefMap:p,getFormProps:T,advanceState:M,getRowConfig:x,getFormActionBindProps:l,originComponentPropsFnMap:S}},Nt=a=>{const{formState:h,emit:f}=a,{compRefMap:v,formModel:y,formPropsRef:d,cacheFormModel:B,schemaFormRef:p,getFormProps:S,defaultFormValues:M,originComponentPropsFnMap:T}=h,x=e=>t=>{t&&v.set(e,t)};function l(){return s(p)?ne(nt(s(y))):{}}function F(e){var t;return(t=s(d).schemas)==null?void 0:t.some(r=>r.field===e&&_(r.component)?Ct.includes(r.component):!1)}async function w(e){const t=s(d).schemas,r=t.map(i=>i.field).filter(Boolean);Object.assign(B,e);const c=[];Object.entries(e).forEach(([i,u])=>{const A=t.find(L=>L.field===i),C=Reflect.has(e,i);if(_(A==null?void 0:A.component)&&(u=kt(A==null?void 0:A.component,u)),C&&r.includes(i)){if(F(i))if(Array.isArray(u)){const L=[];for(const K of u)L.push(K?Ce(K):null);X(y,i,L)}else{const{componentProps:L}=A||{};let K=L;R(L)&&(K=K({formPropsRef:d,formModel:y})),X(y,i,u?K!=null&&K.valueFormat?u:Ce(u):null)}else X(y,i,u);c.push(i)}}),await H(c).catch(i=>{})}async function V(e){let t=[];Z(e)&&t.push(e),te(e)&&(t=[...e]),s(d).schemas=t}async function g(e,t,r=!1){const c=[...s(d).schemas],i=c.findIndex(u=>u.field===t);if(!t||i===-1||r){r?c.unshift(e):c.push(e),d.value.schemas=c;return}i!==-1&&c.splice(i+1,0,e),d.value.schemas=c,P(d.value.schemas)}async function m(e){const t=[...s(d).schemas];if(!e)return;let r=_(e)?[e]:e;_(e)&&(r=[e]);for(const c of r)if(_(c)){const i=t.findIndex(u=>u.field===c);i!==-1&&(Oe(y,c),t.splice(i,1))}d.value.schemas=t}function O(e){return s(d).schemas.find(t=>e===t.field)}const k=e=>{let t=[];if(Z(e)&&t.push(e),te(e)&&(t=[...e]),!t.every(u=>u.component==="Divider"||Reflect.has(u,"field")&&u.field)){console.error("All children of the form Schema array that need to be updated must contain the `field` field");return}const c=[],i=[];s(d).schemas.forEach(u=>{const A=t.find(C=>u.field===C.field);if(A){const C=A.componentProps,L=Ie(u,A);if(T.has(u.field)){const K=T.get(u.field);L.componentProps=J=>({...K(J),...R(C)?C(J):C})}i.push(L),c.push(L)}else c.push(u)}),P(i),d.value.schemas=Pt(c,"field")};function P(e){let t=[];Z(e)&&t.push(e),te(e)&&(t=[...e]);const r={},c=l();t.forEach(i=>{i.component!="Divider"&&Reflect.has(i,"field")&&i.field&&!Me(i.defaultValue)&&(!(i.field in c)||Me(c[i.field]))&&(r[i.field]=i.defaultValue)}),w(r)}async function G(){const{resetFunc:e,submitOnReset:t}=s(S);R(e)&&await e(),Object.keys(y).forEach(r=>{X(y,r,M[r])}),f("reset",y),t&&o(),setTimeout(W)}async function H(e){var t;return(t=p.value)==null?void 0:t.validateFields(e)}async function E(e){return await p.value.validate(e)}async function W(e){var t;await((t=p.value)==null?void 0:t.clearValidate(e))}async function fe(e,t){var r;await((r=p.value)==null?void 0:r.scrollToField(e,t))}const le=(e,t)=>{var c;X(y,e,t),X(B,e,t);const{validateTrigger:r}=s(S);(!r||r==="change")&&((c=p.value)==null||c.validateFields([e]))},me=e=>Oe(y,e),pe=e=>{const{schemas:t}=d.value;d.value=Ie(s(d)||{},e),d.value.schemas=t!=null&&t.length?t:e.schemas};function ne(e){var r,c;if(!Z(e))return{};const t={};for(let[i,u]of Object.entries(e)){if(!i||te(u)&&u.length===0||R(u))continue;const{transformDateFunc:A}=s(S);Z(u)&&(u=A==null?void 0:A(u)),te(u)&&((r=u[0])!=null&&r.format)&&((c=u[1])!=null&&c.format)&&(u=u.map(L=>A==null?void 0:A(L))),_(u)&&(u=u.trim());const C=O(i);if(R(C==null?void 0:C.transform)&&(u=C==null?void 0:C.transform(u),Z(u))){Object.assign(t,u),Reflect.deleteProperty(t,i);continue}X(t,i,u)}return he(t)}function he(e){const t=s(S).fieldMapToTime;if(!t||!Array.isArray(t))return e;for(const[r,[c,i],u="YYYY-MM-DD"]of t){if(!r||!c||!i||!e[r])continue;const[A,C]=e[r];if(!A||!C){Reflect.deleteProperty(e,r);continue}e[c]=Te(A).format(u),e[i]=Te(C).format(u),Reflect.deleteProperty(e,r)}return e}const n=e=>{const{autoSubmitOnEnter:t}=s(d);if(t&&e.key==="Enter"&&e.target&&e.target instanceof HTMLElement){const r=e.target;r&&r.tagName&&r.tagName.toUpperCase()=="INPUT"&&o(e)}};async function o(e){var c;(c=e==null?void 0:e.preventDefault)==null||c.call(e);const{submitFunc:t}=s(S);if(t&&R(t)){await t();return}if(s(p))try{const i=await E(),u=ne(i);return f("submit",u),u}catch(i){return Promise.reject(i)}}return{submit:o,setItemRef:x,clearValidate:W,validate:E,validateFields:H,getFieldsValue:l,updateSchema:k,resetSchema:V,getSchemaByField:O,appendSchemaByField:g,removeSchemaByField:m,resetFields:G,setFieldsValue:w,scrollToField:fe,setDefaultValue:P,setFormModel:le,delFormModel:me,setSchemaFormProps:pe,handleFormValues:ne,handleEnterPress:n}};let qt,Ut,zt;function Gt(){return{screenRef:b(()=>s(qt)),widthRef:Ut,screenEnum:ct,realWidthRef:zt}}const ee=24,Ht=a=>{const{formState:h,emit:f}=a,v=xe(),{realWidthRef:y,screenEnum:d,screenRef:B}=Gt(),{advanceState:p,getFormProps:S,formPropsRef:M,formModel:T,defaultFormValues:x}=h,l=b(()=>{if(!p.isAdvanced)return 0;const g=s(S).emptySpan||0;if(Pe(g))return g;if(Z(g)){const{span:m=0}=g,O=s(B);return g[O.toLowerCase()]||m||0}return 0});de([()=>M.value.schemas,()=>p.isAdvanced,()=>s(y)],()=>{const{showAdvancedButton:g}=s(S);g&&w()},{immediate:!0});function F(g,m=0,O=!1){const k=s(y),P=parseInt(g.md)||parseInt(g.xs)||parseInt(g.sm)||g.span||ee,G=parseInt(g.lg)||P,H=parseInt(g.xl)||G,E=parseInt(g.xxl)||H;return k<=d.LG?m+=P:k<d.XL?m+=G:k<d.XXL?m+=H:m+=E,O?(p.hideAdvanceBtn=!1,m<=ee*2?(p.hideAdvanceBtn=!0,p.isAdvanced=!0):m>ee*2&&m<=ee*(s(S).autoAdvancedLine||3)?p.hideAdvanceBtn=!1:p.isLoad||(p.isLoad=!0,p.isAdvanced=!p.isAdvanced),{isAdvanced:p.isAdvanced,itemColSum:m}):m>ee*(s(S).alwaysShowLines||1)?{isAdvanced:p.isAdvanced,itemColSum:m}:{isAdvanced:!0,itemColSum:m}}function w(){let g=0,m=0;const{baseColProps:O={}}=s(S);for(const k of s(M).schemas){const{vShow:P,colProps:G}=k;let H=!0;if(oe(P)&&(H=P),R(P)&&(H=P({schema:b(()=>s(formSchemasRef).schemas.find(E=>E.field===k.field)),formModel:T,field:k.field,formInstance:v,values:{...s(x),...T}})),H&&(G||O)){const{itemColSum:E,isAdvanced:W}=F({...O,...G},g);g=E||0,W&&(m=g),k.isAdvanced=W}}p.actionSpan=m%ee+s(l),F(s(S).actionColOptions||{span:ee},g,!0),f("advanced-change")}function V(){p.isAdvanced=!p.isAdvanced}return{handleToggleAdvanced:V}},un=ce({name:"SchemaForm",__name:"schema-form",props:it,emits:lt,setup(a,{expose:h,emit:f}){const v=a,y=f,d=Kt(v),{formModel:B,getRowConfig:p,schemaFormRef:S,getFormProps:M,getFormActionBindProps:T,formPropsRef:x}=d,l=Nt({formState:d,emit:y}),{handleEnterPress:F,setDefaultValue:w}=l,V={props:v,emit:y,...d,...l};It(V);const{handleToggleAdvanced:g}=Ht({formState:d,emit:y});return y("register",V),h(V),w(x.value.schemas),(m,O)=>(I(),$(s(Re),q({ref_key:"schemaFormRef",ref:S},s(bt)(s(M),s(ut)),{model:s(B),onKeypress:st(s(F),["enter"])}),{default:z(()=>[j(s(Rt),Q(ke(s(p))),{default:z(()=>[Y(m.$slots,"formHeader"),Y(m.$slots,"default",{},()=>[(I(!0),be(ae,null,we(s(x).schemas,k=>(I(),$(se(ot(Vt,{},m.$slots)),{key:k.field,"form-model":s(B),"onUpdate:formModel":O[0]||(O[0]=P=>at(B)?B.value=P:null),schema:k,"table-instance":m.tableInstance},null,40,["form-model","schema","table-instance"]))),128)),m.showActionButtonGroup?(I(),$(Wt,q({key:0},s(T),{onToggleAdvanced:s(g)}),$e({_:2},[we(["resetBefore","submitBefore","advanceBefore","advanceAfter"],k=>({name:k,fn:z(P=>[Y(m.$slots,k,Q(ke(P||{})))])}))]),1040,["onToggleAdvanced"])):U("",!0)]),Y(m.$slots,"formFooter")]),_:3},16)]),_:3},16,["model","onKeypress"]))}});export{Vt as S,un as _,Me as a,Lt as b,Rt as c,Ve as d,oe as i,Tt as s};
